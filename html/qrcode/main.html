<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8"/>
    <title>analyse QR Code</title>
    <link rel="stylesheet" href="../../css/theme.css"/>

    <style>
        body, html{
            padding: 0;
            margin: 0;
            height: 100%;
        }

        body {
            text-align: center;
        }

        body *{
            font-weight: bold;
        }

        textarea {
            min-width: 90%;
            max-width: 90%;
            min-height: 16vh;
            line-height: 3vh;
            font-size: 2vh;
        }

        button {
            font-size: 3vh;
            border-width: 0.5vh;
        }

        #qrcode canvas {
            display: none;
        }

        #delib2 {
            position: absolute;
            bottom: 10px;
            left: 10px;
            font-size: 12px;
            color: gray;
        }

        .show {
            width: 49%;
            margin: 10px 0;
            padding: 10px 0;
            border-style: solid;
            border-color: white;
        }

        .img-div {
            width: 300px;
            margin: 10px calc(50% - 160px);
            border: 10px solid white;
        }
        .img-div img{
            width: 100%;
            display: block;
        }

        table {
            border-collapse: collapse;
        }
        .grid{
            display: flex;
            flex-direction: row;
            /* align-items: flex-end; 底部对齐 */
            /* justify-content: center; 水平居中对齐 */
        }
        .top {
            align-self: flex-start; /* 顶部对齐 */
        }
        .bottom {
            align-self: flex-end; /* 底部对齐 */
        }
    </style>

</head>
<body>

    <span id="delib2"></span>
    <div style="height: 30px;"></div>

    <textarea id="url" placeholder="input string here"></textarea>
    <table style="width: 100%;margin: 10px 0;"><tr>
        <td style="width: 50%; border-right: 1px solid white; border-bottom: 1px solid white;vertical-align: top;">
            <button type="button" onclick="generate()">Generate</button>
            <div id="qrcode" class="img-div"></div>
        </td>
        <td style="border-top: 1px solid white;vertical-align: bottom;">
            <div class="img-div">
                <img id="uploadPic">
            </div>
            <button type="button" onclick="analyzeChoose()">Analyze</button>    
        </td>
    </tr></table>
    <textarea id="result" placeholder="the analyzed results are shown here (suport clipboard)"></textarea>


    <script src="../../js/config.js"></script>
    <script src="../../js/base.js"></script>

    <script src="https://cdn.jsdelivr.net/gh/liuyaocool/jslib/qrcode/en/qrcode.min.js"></script>

    <!-- <script src="https://cdn.jsdelivr.net/gh/liuyaocool/jslib/qrcode/delib1/jimp.js"></script> -->
    <script src="https://cdn.jsdelivr.net/gh/liuyaocool/jslib/qrcode/delib1/jsQR.js"></script>

    <script src="https://cdn.jsdelivr.net/gh/liuyaocool/jslib/qrcode/delib2/cli-qrcode.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/liuyaocool/jslib/qrcode/delib2/qr-cli.js"></script>

    <script src="main.js"></script>


    <script>
        // document.addEventListener('DOMContentLoaded', function() {
        //     var domScript = document.createElement('script');
        //     domScript.src = "https://cdn.jsdelivr.net/gh/liuyaocool/jslib/qrcode/delib2/oepncv.js";
        //     domScript.onload = domScript.onreadystatechange = function () {
        //         console.log(readyState);
        //         if (!this.readyState || 'loaded' === this.readyState || 'complete' === this.readyState) {
        //             this.onload = this.onreadystatechange = null;
        //             this.parentNode.removeChild(this);
        //         }
        //     }
        //     document.body.appendChild(domScript);
        // });
        
        // 用此方法才能做到异步
        setTimeout(() => {
            document.getElementById('delib2').innerText = 'analyze enhance libiary loading...';
            let t = Date.now();
            var script = document.createElement('script');
            script.src = 'https://cdn.jsdelivr.net/gh/liuyaocool/jslib/qrcode/delib2/oepncv.js';
            script.async = true;
            document.body.appendChild(script);
            script.onload = function(e) {
                document.getElementById('delib2').innerText = `analyze enhance libiary load ok ${(Date.now() - t) / 1000}s`;
            }
        }, 500);
    </script>

    <!-- <script src="https://static.clewm.net/cli/js/decode/oepncv.js"></script> -->
    <!-- <script src="https://cdn.jsdelivr.net/gh/liuyaocool/jslib/qrcode/delib2/oepncv.js" async></script> -->

</body>
</html>